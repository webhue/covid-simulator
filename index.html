<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />

    <title>Cognetik COVID-19 simulator</title>
    <meta name="description" content="Cognetik COVID-19 Simulation" />
    <meta name="author" content="Cognetik" />

    <link rel="stylesheet" href="css/styles.css?v=1.3" />
  </head>

  <body>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"
      integrity="sha256-4iQZ6BVL4qNKlQ27TExEhBN1HFPvAvAMbFavKKosSWQ="
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
    <script src="https://unpkg.com/file-saverjs@1.3.6/FileSaver.js"></script>
    <script src="https://unpkg.com/tableexport@5.2.0/dist/js/tableexport.js"></script>
    <script src="covid.js?v=1.3"></script>
    <div id="parameters">
      <fieldset>
        <legend>Population</legend>
        <input id="population" value="327200000" type="number" />
      </fieldset>
      <fieldset>
        <legend>Initial infections</legend>
        <input id="infections" value="15219" type="number" />
      </fieldset>
      <fieldset>
        <legend>r0</legend>
        <input id="r0" value="2.2" type="number" step="0.1" />
      </fieldset>
      <fieldset>
        <legend>Duration (in days)</legend>
        <input id="duration" value="14" type="number" />
      </fieldset>
      <fieldset>
        <legend>Social Distancing</legend>
        <input id="socialdistancing" value="0.2" type="number" step="0.1" />
      </fieldset>
      <button onclick="update()">Update</button>
    </div>
    <div id="chart" class="chart">
      <canvas id="myChart"></canvas>
    </div>
    <table id="tbl">
      <tr>
        <th>Date</th>
        <th>Healthy</th>
        <th>Infected Today</th>
        <th>Total Infected</th>
        <th>Healed today</th>
        <th>Total Healed</th>
      </tr>
    </table>

    <script>
      var ctx = document.getElementById('myChart').getContext('2d');
      var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: [],
          datasets: [],
        },
        options: {
          maintainAspectRatio: false,
          tooltips: {
            mode: 'label',
            callbacks: {
              title: function(tooltipItem, data) {
                return 'Day ' + (tooltipItem[0] || {}).xLabel;
              },
              label: function(tooltipItem, data) {
                var label = data.datasets[tooltipItem.datasetIndex].label || '';

                if (label) {
                  label += ': ';
                }
                label += new Intl.NumberFormat().format(tooltipItem.yLabel);
                return label;
              },
            },
          },
          scales: {
            yAxes: [
              {
                ticks: {
                  // Include a dollar sign in the ticks
                  callback: function(value, index, values) {
                    return new Intl.NumberFormat().format(value);
                  },
                },
              },
            ],
          },
        },
      });

      var tableExport = new TableExport(document.getElementById('tbl'), {
        formats: ['csv'],
        position: 'top',
        filename: 'cognetik-covid-19-simulator',
      });
    </script>
  </body>
</html>
